{"version":3,"file":"remoteSchema.js","names":["remoteSchema","state","wpUrl","nodeQueries","nonNodeQuery","introspectionData","schemaWasChanged","typeMap","nodeListFilter","field","name","ingestibles","nodeListRootFields","nodeInterfaceTypes","nonNodeRootFields","allowRefreshSchemaUpdate","fetchedTypes","Map","fieldBlacklist","fieldAliases","parent","children","internal","plugin","actionOptions","fields","reducers","toggleAllowRefreshSchemaUpdate","setSchemaWasChanged","payload","addFieldsToBlackList","setState","addFetchedType","type","key","findNamedTypeName","get","kind","possibleTypes","length","set"],"sources":["../../src/models/remoteSchema.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { findNamedTypeName } from \"~/steps/create-schema-customization/helpers\"\n\ninterface IRemoteSchemaState {\n  wpUrl: string\n  nodeQueries: any\n  nonNodeQuery: string\n  introspectionData: any\n  schemaWasChanged: boolean\n  typeMap: any\n  nodeListFilter: (field: { name: string }) => boolean\n  ingestibles: {\n    nodeListRootFields: any\n    nodeInterfaceTypes: any\n    nonNodeRootFields: Array<any>\n  }\n  allowRefreshSchemaUpdate: boolean\n  fetchedTypes: any\n  fieldBlacklist: Array<string>\n  fieldAliases: {\n    parent: string\n    children: string\n    internal: string\n    plugin: string\n    actionOptions: string\n    fields: string\n  }\n}\n\ninterface IRemoteSchemaReducers {\n  toggleAllowRefreshSchemaUpdate: (\n    state: IRemoteSchemaState\n  ) => IRemoteSchemaState\n\n  setSchemaWasChanged: (\n    state: IRemoteSchemaState,\n    payload: boolean\n  ) => IRemoteSchemaState\n\n  addFieldsToBlackList: (\n    state: IRemoteSchemaState,\n    payload: Array<string>\n  ) => IRemoteSchemaState\n\n  setState: (\n    state: IRemoteSchemaState,\n    payload: IRemoteSchemaState\n  ) => IRemoteSchemaState\n\n  addFetchedType: (state: IRemoteSchemaState, type: any) => IRemoteSchemaState\n}\n\ninterface IRemoteSchemaStore {\n  state: IRemoteSchemaState\n  reducers: IRemoteSchemaReducers\n}\n\nconst remoteSchema: IRemoteSchemaStore = {\n  state: {\n    wpUrl: null,\n    nodeQueries: {},\n    nonNodeQuery: null,\n    introspectionData: null,\n    schemaWasChanged: null,\n    typeMap: null,\n    nodeListFilter: (field: { name: string }): boolean =>\n      field.name === `nodes`,\n    ingestibles: {\n      nodeListRootFields: null,\n      nodeInterfaceTypes: null,\n      nonNodeRootFields: [],\n    },\n    allowRefreshSchemaUpdate: false,\n    fetchedTypes: new Map(),\n    fieldBlacklist: [\n      `isWpGatsby`,\n      `edges`,\n      // these aren't useful without authentication\n      `revisions`,\n      `isJwtAuthSecretRevoked`,\n      `isRestricted`,\n      `jwtAuthExpiration`,\n      `jwtAuthToken`,\n      `jwtRefreshToken`,\n      `jwtUserSecret`,\n      `editLock`,\n      `revisionOf`,\n      `preview`,\n      `isPreview`,\n      `previewRevisionDatabaseId`,\n      `previewRevisionId`,\n      `editingLockedBy`,\n      `cursor`,\n    ],\n    // @todo make this a plugin option\n    fieldAliases: {\n      parent: `wpParent`,\n      children: `wpChildren`,\n      internal: `wpInternal`,\n      plugin: `wpPlugin`,\n      actionOptions: `wpActionOptions`,\n      fields: `wpFields`,\n    },\n  },\n\n  reducers: {\n    toggleAllowRefreshSchemaUpdate(state) {\n      state.allowRefreshSchemaUpdate = !state.allowRefreshSchemaUpdate\n\n      return state\n    },\n\n    setSchemaWasChanged(state, payload) {\n      state.schemaWasChanged = !!payload\n\n      return state\n    },\n\n    addFieldsToBlackList(state, payload) {\n      state.fieldBlacklist = [...state.fieldBlacklist, ...payload]\n      return state\n    },\n\n    setState(state, payload) {\n      state = {\n        ...state,\n        ...payload,\n      }\n\n      return state\n    },\n\n    addFetchedType(state, type) {\n      const key = findNamedTypeName(type)\n\n      if (!key) {\n        return state\n      }\n\n      type = state.typeMap.get(key)\n\n      // union types with no member types will cause schema customization errors\n      // @todo move this to a better place. This should be excluded before it gets to this point.\n      if (type && type.kind === `UNION` && type.possibleTypes.length === 0) {\n        return state\n      }\n\n      state.fetchedTypes.set(key, type)\n\n      return state\n    },\n  } as IRemoteSchemaReducers,\n}\n\nexport default remoteSchema\n"],"mappings":";;;;;AACA;;AADA;AAyDA,MAAMA,YAAgC,GAAG;EACvCC,KAAK,EAAE;IACLC,KAAK,EAAE,IADF;IAELC,WAAW,EAAE,EAFR;IAGLC,YAAY,EAAE,IAHT;IAILC,iBAAiB,EAAE,IAJd;IAKLC,gBAAgB,EAAE,IALb;IAMLC,OAAO,EAAE,IANJ;IAOLC,cAAc,EAAGC,KAAD,IACdA,KAAK,CAACC,IAAN,KAAgB,OARb;IASLC,WAAW,EAAE;MACXC,kBAAkB,EAAE,IADT;MAEXC,kBAAkB,EAAE,IAFT;MAGXC,iBAAiB,EAAE;IAHR,CATR;IAcLC,wBAAwB,EAAE,KAdrB;IAeLC,YAAY,EAAE,IAAIC,GAAJ,EAfT;IAgBLC,cAAc,EAAE,CACb,YADa,EAEb,OAFa,EAGd;IACC,WAJa,EAKb,wBALa,EAMb,cANa,EAOb,mBAPa,EAQb,cARa,EASb,iBATa,EAUb,eAVa,EAWb,UAXa,EAYb,YAZa,EAab,SAba,EAcb,WAda,EAeb,2BAfa,EAgBb,mBAhBa,EAiBb,iBAjBa,EAkBb,QAlBa,CAhBX;IAoCL;IACAC,YAAY,EAAE;MACZC,MAAM,EAAG,UADG;MAEZC,QAAQ,EAAG,YAFC;MAGZC,QAAQ,EAAG,YAHC;MAIZC,MAAM,EAAG,UAJG;MAKZC,aAAa,EAAG,iBALJ;MAMZC,MAAM,EAAG;IANG;EArCT,CADgC;EAgDvCC,QAAQ,EAAE;IACRC,8BAA8B,CAAC1B,KAAD,EAAQ;MACpCA,KAAK,CAACc,wBAAN,GAAiC,CAACd,KAAK,CAACc,wBAAxC;MAEA,OAAOd,KAAP;IACD,CALO;;IAOR2B,mBAAmB,CAAC3B,KAAD,EAAQ4B,OAAR,EAAiB;MAClC5B,KAAK,CAACK,gBAAN,GAAyB,CAAC,CAACuB,OAA3B;MAEA,OAAO5B,KAAP;IACD,CAXO;;IAaR6B,oBAAoB,CAAC7B,KAAD,EAAQ4B,OAAR,EAAiB;MACnC5B,KAAK,CAACiB,cAAN,GAAuB,CAAC,GAAGjB,KAAK,CAACiB,cAAV,EAA0B,GAAGW,OAA7B,CAAvB;MACA,OAAO5B,KAAP;IACD,CAhBO;;IAkBR8B,QAAQ,CAAC9B,KAAD,EAAQ4B,OAAR,EAAiB;MACvB5B,KAAK,GAAG,EACN,GAAGA,KADG;QAEN,GAAG4B;MAFG,CAAR;MAKA,OAAO5B,KAAP;IACD,CAzBO;;IA2BR+B,cAAc,CAAC/B,KAAD,EAAQgC,IAAR,EAAc;MAC1B,MAAMC,GAAG,GAAG,IAAAC,0BAAA,EAAkBF,IAAlB,CAAZ;;MAEA,IAAI,CAACC,GAAL,EAAU;QACR,OAAOjC,KAAP;MACD;;MAEDgC,IAAI,GAAGhC,KAAK,CAACM,OAAN,CAAc6B,GAAd,CAAkBF,GAAlB,CAAP,CAP0B,CAS1B;MACA;;MACA,IAAID,IAAI,IAAIA,IAAI,CAACI,IAAL,KAAe,OAAvB,IAAiCJ,IAAI,CAACK,aAAL,CAAmBC,MAAnB,KAA8B,CAAnE,EAAsE;QACpE,OAAOtC,KAAP;MACD;;MAEDA,KAAK,CAACe,YAAN,CAAmBwB,GAAnB,CAAuBN,GAAvB,EAA4BD,IAA5B;MAEA,OAAOhC,KAAP;IACD;;EA7CO;AAhD6B,CAAzC;eAiGeD,Y"}